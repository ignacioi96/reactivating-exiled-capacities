{{- $clusters := where .Site.Pages "Type" "clusters" -}}
[
    {{- range $clusterIndex, $cluster := $clusters -}}
    {
        "title": {{ $cluster.Title | jsonify }},
        "description": {{ $cluster.Params.description | jsonify }},
        "why_matters": {{ $cluster.Params.why_matters | jsonify }},
        "image": {{ $cluster.Params.image | jsonify }},
        "position_x": {{ $cluster.Params.position_x | default 0 }},
        "position_y": {{ $cluster.Params.position_y | default 0 }},
        "capacities": [
            {{- range $capIndex, $capacity := $cluster.Params.capacities -}}
            {
                "title": {{ $capacity.title | jsonify }},
                "subtitle": {{ $capacity.subtitle | jsonify }},
                "what_it_is": {{ $capacity.what_it_is | jsonify }},
                "why_exiled": {{ $capacity.why_exiled | jsonify }},
                "what_possible": {{ $capacity.what_possible | jsonify }},
                "distortions": [
                    {{- range $distIndex, $distortion := $capacity.distortions -}}
                    {
                        "name": {{ $distortion.name | jsonify }},
                        "description": {{ $distortion.description | jsonify }}
                    }{{- if lt $distIndex (sub (len $capacity.distortions) 1) -}},{{- end -}}
                    {{- end -}}
                ],
                "color": {{ $capacity.color | default "#8b5cf6" | jsonify }},
                "position_x": {{ $capacity.position_x | default 0 }},
                "position_y": {{ $capacity.position_y | default 0 }}
            }{{- if lt $capIndex (sub (len $cluster.Params.capacities) 1) -}},{{- end -}}
            {{- end -}}
        ]
    }{{- if lt $clusterIndex (sub (len $clusters) 1) -}},{{- end -}}
    {{- end -}}
]